CREATE DATABASE TUYENSINH;

USE TUYENSINH;

CREATE TABLE THISINH(
THISINHID INT NOT NULL PRIMARY KEY,
TENTHISINH VARCHAR(255) DEFAULT NULL,
NGAYSINH DATE DEFAULT NULL,
DIACHI VARCHAR(255) DEFAULT NULL
);
CREATE TABLE MONTHI(
MONTHIID INT PRIMARY KEY,
TENMONTHI VARCHAR(255) DEFAULT NULL,
HESO INT DEFAULT NULL
);
CREATE TABLE KETQUA(
THISINHID INT NOT NULL,
MONTHIID INT NOT NULL,
DIEM NUMBER(4,2) DEFAULT NULL,
NGAYCAPNHAT DATE DEFAULT NULL,
FOREIGN KEY(THISINHID) REFERENCES THISINH(THISINHID),
FOREIGN KEY(MONTHIID) REFERENCES MONTHI(MONTHIID)

);
INSERT INTO THISINH(THISINHID,TENTHISINH,NGAYSINH,DIACHI)
VALUES ('1','Nguyen Van A','10/05/2002','Ha Noi');
INSERT INTO THISINH(THISINHID, TENTHISINH,NGAYSINH,DIACHI)
VALUES( '2','Tran Van C','20/6/2002','Thai Nguyen');

UPDATE MONTHI
  SET
TENMONTHI = 'Mon van'
WHERE
 TENMONTHI = 'Mon thi thu nhat';

DELETE FROM THISINH WHERE DIACHI IS NULL; 

SELECT * FROM MONTHI WHERE TENMONTHI LIKE '%T%';

SELECT * FROM KETQUA 
WHERE 
NGAYCAPNHAT>'1/6/2020' AND NGAYCAPNHAT < '20/6/2020';

SELECT TENTHISINH, TENMONTHI, DIEM FROM 
THISINH INNER JOIN KETQUA 
ON THISINH.THISINHID = KETQUA.THISINHID
INNER JOIN MONTHI
ON KETQUA.MONTHIID = MONTHI.MONTHIID
WHERE DIEM IS NOT NULL;

SELECT THISINHID, TENTHISINH 
FROM THISINH
WHERE THISINHID NOT IN
(SELECT THISINHID FROM KETQUA);

SELECT DIACHI, COUNT(*) FROM THISINH GROUP BY DIACHI;

SELECT THISINH.TENTHISINH, SUM(KETQUA.DIEM*MONTHI.HESO) AS DIEM  FROM THISINH
INNER JOIN KETQUA ON THISINH.THISINHID = KETQUA.THISINHID
INNER JOIN MONTHI ON MONTHI.MONTHIID = KETQUA.MONTHIID GROUP BY THISINH.TENTHISINH;

SELECT TENTHISINH FROM THISINH
INNER JOIN KETQUA ON THISINH.THISINHID = KETQUA.THISINHID
INNER JOIN MONTHI ON MONTHI.MONTHIID = KETQUA.MONTHIID
WHERE TENMONTHI = 'TOAN' AND DIEM =
  (SELECT MAX(DIEM) FROM KETQUA 
  INNER JOIN MONTHI 
  ON KETQUA.MONTHIID = MONTHI.MONTHIID 
  WHERE TENMONTHI = 'TOAN');
